package fabric

import (
	"encoding/base64"
	"fmt"
	"github.com/golang/protobuf/proto"
	pb "github.com/hyperledger/fabric-protos-go/peer"
	"testing"
)

func TestParseRequest(t *testing.T) {
	//data := "Cq0KCsMJCpgBCAMaDAiaw7H0BRCorfLqAiIcYXBwMDAwNjIwMjAwNDA3MTUyOTU4NjgxMjQ2NipANTgyZGFhMzg1NmQzMzBlN2UwMzUxYWEyNDZiZjFkNGY0YmE5YjBlYWJiYmExMGRjYmEzZmQyNGZhZDVmNjhlYjomEiQSImNjX2FwcDAwMDYyMDIwMDQwNzE1Mjk1ODY4MTI0NjZfMDASpQgKiAgKCkhvbmd6YW9NU1AS+QctLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJQ3dqQ0NBbWlnQXdJQkFnSVVFUTZXNFJaWXp3RjFQK09sT0o3NURPMytXbm93Q2dZSUtvWkl6ajBFQXdJdwpVakVMTUFrR0ExVUVCaE1DUTA0eEVEQU9CZ05WQkFnVEIwSmxhV3BwYm1jeEREQUtCZ05WQkFvVEEwSlRUakVQCk1BMEdBMVVFQ3hNR1kyeHBaVzUwTVJJd0VBWURWUVFERXdsaWMyNXliMjkwWTJFd0lCY05NakF3TkRBM01UQXoKTWpBd1doZ1BNakEzTlRBek1qVXhNRE0zTURCYU1Hd3hPekFOQmdOVkJBc1RCbU5zYVdWdWREQU9CZ05WQkFzVApCMmh2Ym1kNllXOHdEZ1lEVlFRTEV3ZGljMjVuWVhSbE1Bb0dBMVVFQ3hNRFkyOXRNUzB3S3dZRFZRUUREQ1J6ClpHdDBaWE4wUUdGd2NEQXdNRFl5TURJd01EUXdOekUxTWprMU9EWTRNVEkwTmpZd1dUQVRCZ2NxaGtqT1BRSUIKQmdncWhrak9QUU1CQndOQ0FBUmpMRVJiZjhycmFwYzUxQ1pKRjBpcFE1V3NENFd6TUNpcGhQdDNGT2tZVkJwawpKU2xnak44a0MwVTEzcnI3eUhJMks5Mkxwa1ZycCtFVGNVN2xmQkFIbzRIL01JSDhNQTRHQTFVZER3RUIvd1FFCkF3SUhnREFNQmdOVkhSTUJBZjhFQWpBQU1CMEdBMVVkRGdRV0JCUUJQdzU1NEVnckN3U2NnbC9TUFNJWWFRNGwKS3pBZkJnTlZIU01FR0RBV2dCUUNmUFhrZWlWYXlCa2FHQ1ZhSzcvY0ZEdTJSRENCbXdZSUtnTUVCUVlIQ0FFRQpnWTU3SW1GMGRISnpJanA3SW1obUxrRm1abWxzYVdGMGFXOXVJam9pYUc5dVozcGhieTVpYzI1bllYUmxMbU52CmJTSXNJbWhtTGtWdWNtOXNiRzFsYm5SSlJDSTZJbk5rYTNSbGMzUkFZWEJ3TURBd05qSXdNakF3TkRBM01UVXkKT1RVNE5qZ3hNalEyTmlJc0ltaG1MbFI1Y0dVaU9pSmpiR2xsYm5RaUxDSnliMnhsSWpvaVkyeHBaVzUwSW4xOQpNQW9HQ0NxR1NNNDlCQU1DQTBnQU1FVUNJUURLREI2Vm8ycWExem1qZGdEZGpJY1hvMHQvZzhVWStOa2xoR2pDClhLb3pyZ0lnS2JJaFNKQ0w5NHJ1T3NPU21MRTAwYnp5R3NMZlNDeGJSQko3ZDl2SGR1MD0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQoSGPoAtTXSeLzpmBV6PzlihJLZoVwzWN627BJlCmMKYQgBEiQSImNjX2FwcDAwMDYyMDIwMDQwNzE1Mjk1ODY4MTI0NjZfMDAaNwoDc2V0CjB7ImJhc2VLZXkiOiJ0ZXN0IiwiYmFzZVZhbHVlIjoidGhpcyBpcyBzdHJpbmcgIn0SRzBFAiEAwQEZy/3VW5M+/eIn0Srn9Uu8MRf3elDdcgTozzPSdJgCIHB1YdPOh6rsI5jgcGvnH5TNFkqty3TWl4S2TbXfL6Vw"

	data := "CsMKCtIJCpcBCAMaCwijkIb1BRCAw4VmIhxhcHAwMDAxMjAyMDA0MTYxMDIwMTUyOTE4NDUxKkBiNTY4NzAwYWQ0ZDJmMDNjOTM5OTdkMWRiMjVmNzU2ZDhmMTAyYTY2OGJlN2RlYTUwNjU3MzEyMjRjMGNiZGMyOiYSJBIiY2NfYXBwMDAwMTIwMjAwNDE2MTAxNzE0MTIzMzkyMF8wMBK1CAqYCAoLT3JnYk5vZGVNU1ASiAgtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS1NSUlDMlRDQ0FuK2dBd0lCQWdJVUlsR0JUOG8rRWRIalF3U0QyK3gycEI1aE5WWXdDZ1lJS29aSXpqMEVBd0l3VGpFTE1Ba0dBMVVFQmhNQ1EwNHhFREFPQmdOVkJBZ1RCMEpsYVdwcGJtY3hEREFLQmdOVkJBb1RBMEpUVGpFUE1BMEdBMVVFQ3hNR1kyeHBaVzUwTVE0d0RBWURWUVFERXdWaWMyNWpZVEFnRncweU1EQTBNak14TVRReU1EQmFHQTh5TVRBd01ETXlNVEV4TURRd01Gb3dmekVMTUFrR0ExVUVCaE1DUTA0eFBEQU5CZ05WQkFzVEJtTnNhV1Z1ZERBUEJnTlZCQXNUQ0c5eVoySnViMlJsTUE0R0ExVUVDeE1IWW5OdVltRnpaVEFLQmdOVkJBc1RBMk52YlRFeU1EQUdBMVVFQXd3cGRHVnpkREF3TVRBeE1EQXlRR0Z3Y0RBd01ERXlNREl3TURReE5qRXdNakF4TlRJNU1UZzBOVEV3V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVN5VlhlT2tVeWVBSlBKUGp5TVFObHBSR0lObVp4OFZLRit6aGpkR0JPT1oxaGpQL0N4UzR2ME5vd1AybTBsMnFiN3p2RjFiVWFiNCtkM3VUQWF1RXE3bzRJQkJqQ0NBUUl3RGdZRFZSMFBBUUgvQkFRREFnZUFNQXdHQTFVZEV3RUIvd1FDTUFBd0hRWURWUjBPQkJZRUZDbUpEZFVlR3FhK2N4YTk0dE8zL2NDT0MvNFhNQjhHQTFVZEl3UVlNQmFBRkFjSTRIK2tJczh2bjk0WllZcGtyZCs1bGRNS01JR2hCZ2dxQXdRRkJnY0lBUVNCbEhzaVlYUjBjbk1pT25zaWFHWXVRV1ptYVd4cFlYUnBiMjRpT2lKdmNtZGlibTlrWlM1aWMyNWlZWE5sTG1OdmJTSXNJbWhtTGtWdWNtOXNiRzFsYm5SSlJDSTZJblJsYzNRd01ERXdNVEF3TWtCaGNIQXdNREF4TWpBeU1EQTBNVFl4TURJd01UVXlPVEU0TkRVeElpd2lhR1l1Vkhsd1pTSTZJbU5zYVdWdWRDSXNJbkp2YkdVaU9pSmpiR2xsYm5RaWZYMHdDZ1lJS29aSXpqMEVBd0lEU0FBd1JRSWhBTnkwa1BOM0x2UC9YK0dRenUzckwyVDNpVTljNC8vUlcwa25iL2tEbDFEWkFpQng5MXQvT0JsajQrWitjeHFaL2dMUzhlNUxlNzZQb1p2SEJuVi9kQ1hoNXc9PS0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0SGGC0ILs4UdnUesuTPb5wOZv2yS2jOvAdTxJsCmoKaAgEEiQSImNjX2FwcDAwMDEyMDIwMDQxNjEwMTcxNDEyMzM5MjBfMDAaPgoDc2V0Cjd7ImJhc2VLZXkiOiJ0ZXN0MjAyMDA0OCIsImJhc2VWYWx1ZSI6InRoaXMgaXMgc3RyaW5nICJ9EkcwRQIhAKEhHIxE0wB6OwuGaA/ltPYyUu8ZGjH34vrRnHkfVV3qAiBeRX/SB0iyLwwCqrML4tnafu0R5bifIPenwj7uPFh7Rg=="
	ParseRequest(data)

}

func TestParseRequest2(t *testing.T) {

	chaincodeId := "abc"

	chain := &pb.ChaincodeID{Name: chaincodeId}

	bttes, _ := proto.Marshal(chain)

	fmt.Println(base64.StdEncoding.EncodeToString(bttes))

}

func TestConvertToTran(t *testing.T) {
	data := "CtkfCo4fCpYKCpgBCAMaDAiSrveMBhCYpNi5AiIcYXBwMDAwMTIwMjExMTEyMTY0NzM5NjE1MzYzMSpANTVmY2ZlMWU0OGZiOTZmZmQyY2Y2MzUwMWU3ZmQzZTU0NjBhNDU2MjM5YzhiMzk1NmE4ZWY3MTMwNTg4NjgyMjomEiQSImNjX2FwcDAwMDEyMDIxMTExMjE2NDczOTYxNTM2MzFfMDES+AgK2wgKC09yZ2FOb2RlTVNQEssILS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvekNDQXFXZ0F3SUJBZ0lVTHRqbjhUdzAyUVpOaFNUUlNGVWk5dnF1Vk1zd0NnWUlLb1pJemowRUF3SXcKVGpFTE1Ba0dBMVVFQmhNQ1EwNHhFREFPQmdOVkJBZ1RCMEpsYVdwcGJtY3hEREFLQmdOVkJBb1RBMEpUVGpFUApNQTBHQTFVRUN4TUdZMnhwWlc1ME1RNHdEQVlEVlFRREV3VmljMjVqWVRBZ0Z3MHlNREEwTURreE1EVTRNREJhCkdBOHlNVEF3TURNeU1URXhNRE13TUZvd2daQXhDekFKQmdOVkJBWVRBa05PTVJBd0RnWURWUVFJRXdkQ1pXbHEKYVc1bk1Rd3dDZ1lEVlFRS0V3TkNVMDR4UERBTkJnTlZCQXNUQm1Oc2FXVnVkREFQQmdOVkJBc1RDRzl5WjJGdQpiMlJsTUE0R0ExVUVDeE1IWW5OdVltRnpaVEFLQmdOVkJBc1RBMk52YlRFak1DRUdBMVVFQXd3YVFXUnRhVzVBCmIzSm5ZVzV2WkdVdVluTnVZbUZ6WlM1amIyMHdXVEFUQmdjcWhrak9QUUlCQmdncWhrak9QUU1CQndOQ0FBUlEKR3FuVlErNGk1a0kwNER5L3hXaEdpQ1lKYktaOHAzMXB3MkVkdnJRY2xDcEpEWGdpanJhdWxMbHAxRnNlU0pZQgpzUDF2NnJvM2FiQjBFdktRYVhLQm80SUJHakNDQVJZd0RnWURWUjBQQVFIL0JBUURBZ2VBTUF3R0ExVWRFd0VCCi93UUNNQUF3SFFZRFZSME9CQllFRkFxT1o0NGFVdURmWWRGOVVCNkhaelk1aWQzME1COEdBMVVkSXdRWU1CYUEKRklma1hOckxVc2pmc0lURDN3TkIyOGt3OVFHek1DSUdBMVVkRVFRYk1CbUNGMk5oTG05eVoyRnViMlJsTG1KegpibUpoYzJVdVkyOXRNSUdSQmdncUF3UUZCZ2NJQVFTQmhIc2lZWFIwY25NaU9uc2lhR1l1UVdabWFXeHBZWFJwCmIyNGlPaUp2Y21kaGJtOWtaUzVpYzI1aVlYTmxMbU52YlNJc0ltaG1Ma1Z1Y205c2JHMWxiblJKUkNJNklrRmsKYldsdVFHOXlaMkZ1YjJSbExtSnpibUpoYzJVdVkyOXRJaXdpYUdZdVZIbHdaU0k2SW1Oc2FXVnVkQ0lzSW5KdgpiR1VpT2lKaFpHMXBiaUo5ZlRBS0JnZ3Foa2pPUFFRREFnTklBREJGQWlFQWhrSUUvcFcveHpGTTFhQTBvcmhsCmdoVlhUbWNRWk45ckI5N1N0dFJoNjFvQ0lHaEs1OEJxYzA3MjFkVE5IODdSRXY3cWIveFNtK2dKZjRkc2F2QnIKaHFmeAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tChIY9YWpApVsskckru8IZ7cT5Wcp+XZ/cHE0EvIUCu8UCrcICpoICgtPcmdhTm9kZU1TUBKKCC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlDenpDQ0FuYWdBd0lCQWdJSVIydnRUdjc0UlJZd0NnWUlLb1pJemowRUF3SXdUakVMTUFrR0ExVUVCaE1DClEwNHhFREFPQmdOVkJBZ1RCMEpsYVdwcGJtY3hEREFLQmdOVkJBb1RBMEpUVGpFUE1BMEdBMVVFQ3hNR1kyeHAKWlc1ME1RNHdEQVlEVlFRREV3VmljMjVqWVRBZ0Z3MHlNVEV4TWpRd05qQTROVFZhR0E4eU1UQXdNVEV5TkRBMgpNRGcxTlZvd1V6RU1NQW9HQTFVRUNnd0RRbk51TVE4d0RRWURWUVFMREFaamJHbGxiblF4TWpBd0JnTlZCQU1NCktYVnpaWEl5TURJeE1URXlORUJoY0hBd01EQXhNakF5TVRFeE1USXhOalEzTXprMk1UVXpOak14TUZrd0V3WUgKS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRTRxYURTVnlxQUlCSXB0S1VDTG1oZS93UGdUR1grRmF4azlPVwoxQmd0YmZIYUNUdlRrNXB6bDdpU0NLZFR5MEtHSWhSTi9qV2lKL0VabnRWWGx5VU1yNk9DQVRVd2dnRXhNQXdHCkExVWRFd0VCL3dRQ01BQXdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1CMEdBMVVkRGdRV0JCUlRtRTVhWjlUYkxPeWYKbUovRkY0bEd1clFBdFRBZkJnTlZIU01FR0RBV2dCU0g1RnpheTFMSTM3Q0V3OThEUWR2Sk1QVUJzekFpQmdOVgpIUkVFR3pBWmdoZGpZUzV2Y21kaGJtOWtaUzVpYzI1aVlYTmxMbU52YlRDQnJBWUlLZ01FQlFZSENBRUVnWjk3CkltRjBkSEp6SWpwN0ltdGxlVEVpT2lKaFltTWlMQ0p5YjJ4bElqb2lkWE5sY2lJc0ltaG1Ma0ZtWm1sc2FXRjAKYVc5dUlqb2liM0puWVc1dlpHVXVZbk51WW1GelpTNWpiMjBpTENKb1ppNUZibkp2Ykd4dFpXNTBTVVFpT2lKMQpjMlZ5TWpBeU1URXhNalJBWVhCd01EQXdNVEl3TWpFeE1URXlNVFkwTnpNNU5qRTFNell6TVNJc0ltaG1MbFI1CmNHVWlPaUpqYkdsbGJuUWlmWDB3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnYWhoVXhEUXFOVFBoZ1JPSTUvSFEKak1GWTVlYVFjR0U4NVUxbElKRzV4dHdDSUYzbWdZZlV2UXQ1TGlmdFFxNlBEYXRJNy8rSG9tSzB4US9ZcUhJLwphWDJwCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KEhj1hakClWyyRySu7whntxPlZyn5dn9wcTQSsgwKbQprCmkIARIkEiJjY19hcHAwMDAxMjAyMTExMTIxNjQ3Mzk2MTUzNjMxXzAxGj8KA3NldAo4eyJiYXNlS2V5IjoidGVzdDIwMjExMDMxIiwiYmFzZVZhbHVlIjoidGhpcyBpcyBzdHJpbmcgIn0SwAsKrQIKICFm0y0BTJYgreW0rBn0IT8DIaPkNX9Kg04KDXs9UI5hEogCCsgBEpEBCiJjY19hcHAwMDAxMjAyMTExMTIxNjQ3Mzk2MTUzNjMxXzAxEmsKFwoVYmFzZV9rZXlfdGVzdDIwMjExMDMxGlAKFWJhc2Vfa2V5X3Rlc3QyMDIxMTAzMRo3eyJCYXNlS2V5IjoidGVzdDIwMjExMDMxIiwiQmFzZUluZm8iOiJ0aGlzIGlzIHN0cmluZyAifRIyCgRsc2NjEioKKAoiY2NfYXBwMDAwMTIwMjExMTEyMTY0NzM5NjE1MzYzMV8wMRICCAEaDAjIARoHU1VDQ0VTUyItEiJjY19hcHAwMDAxMjAyMTExMTIxNjQ3Mzk2MTUzNjMxXzAxGgcxLjAuMC4xEo0JCsIICgtPcmdhTm9kZU1TUBKyCC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlDN1RDQ0FwT2dBd0lCQWdJVVNCNHJ5ZGZ3eXowNitxUHNrS2t3U3J5YkhNNHdDZ1lJS29aSXpqMEVBd0l3ClRqRUxNQWtHQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFXcHBibWN4RERBS0JnTlZCQW9UQTBKVFRqRVAKTUEwR0ExVUVDeE1HWTJ4cFpXNTBNUTR3REFZRFZRUURFd1ZpYzI1allUQWdGdzB5TURBME1Ea3hNRFU0TURCYQpHQTh5TVRBd01ETXlNVEV4TURNd01Gb3dnWTR4Q3pBSkJnTlZCQVlUQWtOT01SQXdEZ1lEVlFRSUV3ZENaV2xxCmFXNW5NUXd3Q2dZRFZRUUtFd05DVTA0eE9qQUxCZ05WQkFzVEJIQmxaWEl3RHdZRFZRUUxFd2h2Y21kaGJtOWsKWlRBT0JnTlZCQXNUQjJKemJtSmhjMlV3Q2dZRFZRUUxFd05qYjIweEl6QWhCZ05WQkFNVEduQmxaWEl5TG05eQpaMkZ1YjJSbExtSnpibUpoYzJVdVkyOXRNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUU5ZXZDClRXOUhYK2FkemZDOFJSMENJY1I3TGdySE05Q0V6OXl6ZDNqY25vNDVCSWpUdmx4OVhIaUd2dW1XRnUvTVlsdlEKMFVQNnU4RG1SQVJKOEM2R2phT0NBUW93Z2dFR01BNEdBMVVkRHdFQi93UUVBd0lIZ0RBTUJnTlZIUk1CQWY4RQpBakFBTUIwR0ExVWREZ1FXQkJRNXpyKzNxUGNQQTd1OWdPellYbjNJVXVIeWJUQWZCZ05WSFNNRUdEQVdnQlNICjVGemF5MUxJMzdDRXc5OERRZHZKTVBVQnN6QWxCZ05WSFJFRUhqQWNnaHB3WldWeU1pNXZjbWRoYm05a1pTNWkKYzI1aVlYTmxMbU52YlRCL0JnZ3FBd1FGQmdjSUFRUnpleUpoZEhSeWN5STZleUpvWmk1QlptWnBiR2xoZEdsdgpiaUk2SW05eVoyRnViMlJsTG1KemJtSmhjMlV1WTI5dElpd2lhR1l1Ulc1eWIyeHNiV1Z1ZEVsRUlqb2ljR1ZsCmNqSXViM0puWVc1dlpHVXVZbk51WW1GelpTNWpiMjBpTENKb1ppNVVlWEJsSWpvaWNHVmxjaUo5ZlRBS0JnZ3EKaGtqT1BRUURBZ05JQURCRkFpRUFtaWpWakpjM0pKcnczQ0ljWWkwSEt0YWJjSTVPa0tyaTkrTENINTYwNmlNQwpJQkFad005VHRVMWZ6a1VBQmZIVXl6TVVqbUs1VG5OQk0ydGxlQTJ2REwyaAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tChJGMEQCIBYP/IS5zjv7rTxUn6xlQ0XXt+6Va3yHQPpN3ToYCnN2AiA9JSHE7SnWhdpkLSvudB862Ks2Wmf+ffzMaPV00mnezhJGMEQCIGqlOy0kia7P/V3XVTbuVM/PbfVM3ceRhSRAreNxCLzaAiB77qanCMhubwL3ThufrKa2gP5bWolQ6ZK8cMDMbOkosg=="

	trans, err := ConvertToTran(data)
	if err != nil {
		t.Fatal(err)
	}

	js, err := ConvertTransToJson(trans)

	if err != nil {
		t.Fatal(err)
	}

	fmt.Println(js)
	//assert.Equal(t, trans.ValidationCode, uint64(0))
}
